<mvc:View controllerName="com.kaar.ehsmportal.controller.IncidentList"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m">
    <Page id="incidentListPage" title="{i18n>incidentListPageTitle}" showNavButton="true" navButtonPress="onNavBack">
        <content>
            <VBox class="sapUiSmallMargin">
                <Table id="incidentsTable" 
                       items="{incidents>/results}"
                       growing="true"
                       growingThreshold="20"
                       mode="SingleSelectMaster">
                    <headerToolbar>
                        <OverflowToolbar>
                            <Title text="{i18n>incidentListTitle}" level="H2"/>
                            <ToolbarSpacer/>
                            <Text text="{i18n>totalIncidentsLabel}: {incidents>/results/length}"/>
                        </OverflowToolbar>
                    </headerToolbar>
                    <columns>
                        <Column width="12em">
                            <Text text="{i18n>incidentIdColumn}"/>
                        </Column>
                        <Column minScreenWidth="Tablet" demandPopin="true">
                            <Text text="{i18n>descColumn}"/>
                        </Column>
                        <Column minScreenWidth="Tablet" demandPopin="true" hAlign="Center">
                            <Text text="{i18n>categoryColumn}"/>
                        </Column>
                        <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                            <Text text="{i18n>priorityColumn}"/>
                        </Column>
                        <Column hAlign="Center">
                            <Text text="{i18n>statusColumn}"/>
                        </Column>
                        <Column minScreenWidth="Desktop" demandPopin="true">
                            <Text text="{i18n>incidentDateColumn}"/>
                        </Column>
                        <Column minScreenWidth="Desktop" demandPopin="true">
                            <Text text="{i18n>completionDateColumn}"/>
                        </Column>
                        <Column minScreenWidth="Tablet" demandPopin="true">
                            <Text text="{i18n>createdByColumn}"/>
                        </Column>
                    </columns>
                    <items>
                        <ColumnListItem>
                            <cells>
                                <ObjectIdentifier title="{incidents>IncidentId}"/>
                                <Text text="{incidents>IncidentDescription}"/>
                                <Text text="{incidents>IncidentCategory}"/>
                                <ObjectStatus 
                                    text="{incidents>IncidentPriority}" 
                                    state="{path: 'incidents>IncidentPriority', formatter: '.formatter.priorityState'}"/>
                                <ObjectStatus 
                                    text="{incidents>IncidentStatus}" 
                                    state="{path: 'incidents>IncidentStatus', formatter: '.formatter.statusState'}"/>
                                <Text text="{path: 'incidents>IncidentDate', type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd/MM/yyyy'}}"/>
                                <Text text="{path: 'incidents>CompletionDate', type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd/MM/yyyy'}}"/>
                                <Text text="{incidents>CreatedBy}"/>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </content>
    </Page>
</mvc:View>
